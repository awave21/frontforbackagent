# HTTP only - static SPA served by nginx (no Node.js server needed)
# Copy to: /etc/nginx/sites-available/front.agentsapp.integration-ai.ru
server {
    listen 80;
    listen [::]:80;
    server_name front.agentsapp.integration-ai.ru;

    # Корневая директория — статические файлы SPA
    root /opt/app-agent/frontforbackagent/.output/public;

    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
        allow all;
    }

    # Nuxt hashed assets — агрессивное кэширование
    location /_nuxt/ {
        add_header Cache-Control "public, max-age=31536000, immutable";
        try_files $uri =404;
    }

    # SPA fallback — все остальные маршруты отдают index.html
    location / {
        try_files $uri $uri/ /index.html;
        add_header Cache-Control "no-cache";
    }
}
