import{_ as Q}from"./nuxt-link.ChvxNO41.js";import{m as S,o as n,c as a,a as o,A as v,b as m,u as l,t as d,d as _,p as C,s as q,F as B,C as D,Q as G,B as H,f as J,n as $,w as K,L as w,k as O,b$ as W}from"./entry.CBkKRCnV.js";import{B as L}from"./bot.DYtIoycp.js";import{S as X}from"./sparkles.C46KeWkI.js";import{S as Y}from"./settings.bgzCNz6L.js";import{M as Z}from"./more-vertical.CGqW9Ll_.js";import{_ as tt}from"./AuthModal.vue.DxMXnGuG.js";import{u as et}from"./useLayoutState.B8IzXTUd.js";import{u as ot}from"./useAgents.C6xV-JRH.js";import{u as st}from"./useAuth.CHSuA4zA.js";import{u as rt}from"./usePermissions.DJmIznYF.js";import{A as nt}from"./alert-circle.DcUsP5Lj.js";import"./eye.DUCx08TH.js";import"./loader-2.CrTaI3Us.js";import"./useApiFetch.B9YviUBz.js";import"./authSessionManager.BK0upO_P.js";const lt={class:"group bg-white rounded-2xl border border-slate-200 p-6 hover:shadow-xl hover:shadow-slate-200/50 transition-all duration-300 hover:-translate-y-1"},it={class:"flex items-start justify-between mb-6"},at={class:"flex items-start gap-4 flex-1 min-w-0"},dt={class:"absolute -bottom-2 -right-2 w-6 h-6 bg-white rounded-full flex items-center justify-center shadow-md"},ut={class:"flex-1 min-w-0"},ct={class:"text-xl font-bold text-slate-900 mb-2 truncate group-hover:text-indigo-600 transition-colors"},mt={class:"flex items-center flex-wrap gap-2"},gt={class:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-medium bg-slate-100 text-slate-700"},pt={class:"flex items-center gap-2 shrink-0 ml-4"},bt={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3"},ft=["title"],xt={class:"text-sm font-bold text-slate-900 mb-0.5 truncate group-hover/stat:text-indigo-600 transition-colors"},ht={class:"text-xs text-slate-500 font-medium"},vt=S({__name:"AgentDetailCard",props:{title:{},icon:{},avatarColor:{},borderColor:{},type:{},stats:{},statsBgColor:{},statsTextColor:{},agentId:{},status:{default:"draft"}},setup(i){const f=i,g=()=>{f.agentId&&G(`/agents/${f.agentId}`)},y=()=>{console.log("Menu toggled")};return(p,u)=>(n(),a("div",lt,[o("div",it,[o("div",at,[o("div",{class:v(["relative flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br shrink-0 shadow-lg",i.avatarColor])},[m(l(L),{class:"h-8 w-8 text-white"}),o("div",dt,[o("div",{class:v(["w-3 h-3 rounded-full",i.status==="published"?"bg-emerald-500":"bg-amber-500"])},null,2)])],2),o("div",ut,[o("h3",ct,d(i.title),1),o("div",mt,[o("span",{class:v(["inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-semibold",[i.status==="published"?"bg-emerald-50 text-emerald-700":"bg-amber-50 text-amber-700"]])},[o("div",{class:v(["w-1.5 h-1.5 rounded-full",i.status==="published"?"bg-emerald-500":"bg-amber-500"])},null,2),_(" "+d(i.status==="published"?"Активен":"Черновик"),1)],2),o("span",gt,[m(l(X),{class:"h-3 w-3"}),_(" "+d(i.type),1)])])])]),o("div",pt,[i.agentId?(n(),a("button",{key:0,onClick:g,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg font-medium hover:from-indigo-600 hover:to-purple-700 transition-all shadow-sm hover:shadow-md"},[m(l(Y),{class:"h-4 w-4"}),u[0]||(u[0]=o("span",{class:"hidden sm:inline"},"Настроить",-1))])):C("",!0),o("button",{class:"p-2.5 bg-slate-50 hover:bg-slate-100 rounded-lg transition-colors group/menu",onClick:q(y,["stop"])},[m(l(Z),{class:"h-5 w-5 text-slate-600 group-hover/menu:text-slate-900"})])])]),o("div",bt,[(n(!0),a(B,null,D(i.stats,b=>(n(),a("div",{key:b.label,class:"group/stat relative rounded-xl p-3 bg-gradient-to-br from-slate-50 to-slate-100/50 hover:from-indigo-50 hover:to-purple-50 transition-all duration-300 cursor-default border border-slate-100 hover:border-indigo-200",title:b.tooltip||void 0},[o("p",xt,d(b.value),1),o("p",ht,d(b.label),1),u[1]||(u[1]=o("div",{class:"absolute inset-0 rounded-xl ring-2 ring-indigo-400 opacity-0 group-hover/stat:opacity-20 transition-opacity pointer-events-none"},null,-1))],8,ft))),128))])]))}}),yt={class:"w-full px-5 py-5 flex flex-col gap-5"},wt={key:0,class:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4"},_t={class:"flex items-center justify-between"},Ct={class:"flex items-center"},At={class:"grid grid-cols-1 md:grid-cols-3 gap-5 mb-8"},kt={class:"bg-white rounded-xl border border-border p-5"},$t={class:"text-3xl font-bold text-green-600"},St={class:"bg-white rounded-xl border border-border p-5"},Bt={class:"text-3xl font-bold text-foreground"},Dt={class:"bg-white rounded-xl border border-border p-5"},Lt={class:"text-3xl font-bold text-indigo-600"},Ut={key:1,class:"flex justify-center py-8"},Ft={key:2,class:"text-center py-12"},Nt={key:3,class:"space-y-5"},Wt=S({__name:"index",setup(i){W();const{pageTitle:f}=et(),{isAuthenticated:g}=st(),{canEditAgents:y}=rt(),{agents:p,fetchAgents:u,isLoading:b}=ot(),U=w(()=>p.value.length),F=w(()=>p.value.filter(t=>t.status==="published").length),N=w(()=>p.value.filter(t=>t.status==="draft").length),x=O(!1);H(async()=>{if(f.value="Мои агенты",g.value)try{await u()}catch(t){console.error("Failed to load agents:",t)}}),J(g,async t=>{t&&await u()});const M=()=>{x.value=!1},j=t=>t.name.toLowerCase().includes("запис")?"UserCheck":t.name.toLowerCase().includes("диагностик")?"Activity":t.name.toLowerCase().includes("документац")?"FileCheck":"Bot",I=t=>{const e=["from-sky-500 to-cyan-500","from-purple-500 to-pink-500","from-emerald-500 to-cyan-500","from-orange-500 to-red-500","from-indigo-500 to-purple-500"],s=t.id.charCodeAt(0)%e.length;return e[s]},T=t=>{const e=["border-sky-100","border-purple-100","border-emerald-100","border-orange-100","border-indigo-100"],s=t.id.charCodeAt(0)%e.length;return e[s]},R=t=>t.system_prompt.toLowerCase().includes("пациент")?"Управление пациентами":t.system_prompt.toLowerCase().includes("диагностик")||t.system_prompt.toLowerCase().includes("анализ")?"Медицинский анализ":t.system_prompt.toLowerCase().includes("документ")?"Документооборот":"Общий помощник",V=t=>{const e=["bg-sky-50","bg-purple-50","bg-emerald-50","bg-orange-50","bg-indigo-50"],s=t.id.charCodeAt(0)%e.length;return e[s]},E=t=>{const e=["text-sky-600","text-purple-600","text-emerald-600","text-orange-600","text-indigo-600"],s=t.id.charCodeAt(0)%e.length;return e[s]},z=t=>{const e=Number(t??0);return Number.isFinite(e)?e:0},A=(t,e)=>{const s=z(t),c=s!==0&&Math.abs(s)<1?4:2;return e==="USD"?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:c}).format(s):new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:2,maximumFractionDigits:c}).format(s)},k=(t,e)=>`Точное значение: ${typeof t=="string"&&t.trim()?t.trim():"0"} ${e}`,P=t=>{var c,h;const e=t.status==="published"?"Опубликован":"Черновик",s=((c=t.model)==null?void 0:c.split(":")[1])||t.model||"Не указана";return[{value:e,label:"Статус"},{value:s,label:"Модель"},{value:((h=t.version)==null?void 0:h.toString())||"1",label:"Версия"},{value:new Date(t.updated_at).toLocaleDateString("ru-RU"),label:"Обновлен"},{value:A(t.total_cost_usd,"USD"),label:"Расход USD",tooltip:k(t.total_cost_usd,"USD")},{value:A(t.total_cost_rub,"RUB"),label:"Расход RUB",tooltip:k(t.total_cost_rub,"RUB")}]};return(t,e)=>{const s=Q,c=vt,h=tt;return n(),a("div",yt,[l(g)?C("",!0):(n(),a("div",wt,[o("div",_t,[o("div",Ct,[m(l(nt),{class:"h-5 w-5 text-yellow-400 mr-3"}),e[2]||(e[2]=o("div",null,[o("h3",{class:"text-sm font-medium text-yellow-800"}," Требуется аутентификация "),o("p",{class:"text-sm text-yellow-700 mt-1"}," Войдите в систему, чтобы получить доступ к управлению агентами ")],-1))]),o("button",{onClick:e[0]||(e[0]=r=>x.value=!0),class:"px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 transition-colors"}," Войти ")])])),o("div",At,[o("div",kt,[e[3]||(e[3]=o("div",{class:"flex items-center justify-between mb-3"},[o("p",{class:"text-sm font-normal text-muted-foreground"},"Активные")],-1)),o("p",$t,d(F.value),1)]),o("div",St,[e[4]||(e[4]=o("div",{class:"flex items-center justify-between mb-3"},[o("p",{class:"text-sm font-normal text-muted-foreground"},"Всего агентов")],-1)),o("p",Bt,d(U.value),1)]),o("div",Dt,[e[5]||(e[5]=o("div",{class:"flex items-center justify-between mb-3"},[o("p",{class:"text-sm font-normal text-muted-foreground"}," Черновики ")],-1)),o("p",Lt,d(N.value),1)])]),l(b)?(n(),a("div",Ut,[...e[6]||(e[6]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):l(p).length===0?(n(),a("div",Ft,[m(l(L),{class:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e[8]||(e[8]=o("h3",{class:"text-lg font-medium text-foreground mb-2"},"Нет агентов",-1)),e[9]||(e[9]=o("p",{class:"text-muted-foreground mb-4"},"Создайте своего первого AI-агента",-1)),l(g)&&l(y)?(n(),$(s,{key:0,to:"/agents/new",class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors"},{default:K(()=>[...e[7]||(e[7]=[_(" Создать агента ",-1)])]),_:1})):C("",!0)])):(n(),a("div",Nt,[(n(!0),a(B,null,D(l(p),r=>(n(),$(c,{key:r.id,"agent-id":r.id,title:r.name,icon:j(r),"avatar-color":I(r),"border-color":T(r),type:R(r),"stats-bg-color":V(r),"stats-text-color":E(r),stats:P(r),status:r.status},null,8,["agent-id","title","icon","avatar-color","border-color","type","stats-bg-color","stats-text-color","stats","status"]))),128))])),m(h,{"is-open":x.value,onClose:e[1]||(e[1]=r=>x.value=!1),onAuthenticated:M},null,8,["is-open"])])}}});export{Wt as default};
