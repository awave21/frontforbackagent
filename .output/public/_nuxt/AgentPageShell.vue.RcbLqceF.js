import{m as k,y as C,f as S,c as a,u as s,a as t,b as m,p as r,t as u,n as p,d as B,K as N,k as $,M as L,N as V,o}from"./entry.O09EqozO.js";import{a as j}from"./useAuth.neUI44RN.js";import{u as E}from"./usePermissions.UhNkZPD1.js";import{u as T}from"./useAgentEditorStore.DTb6YdiW.js";import{_ as M}from"./AuthModal.vue.BC9qfAFg.js";import{A as P}from"./alert-circle.Du6JAHUu.js";import{L as R}from"./loader-2.Co8TrG4J.js";import{C as D}from"./check.CWwi3ast.js";const I={key:0,class:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4"},K={class:"flex items-center justify-between"},q={class:"flex items-center"},z={key:1,class:"flex justify-center py-12"},F={key:2,class:"space-y-6"},G={class:"flex items-center justify-between mb-5"},H={class:"text-3xl font-bold text-slate-900"},J={class:"text-slate-500 mt-1"},O={key:0},Q={key:0,class:"flex items-center gap-3"},U=["disabled"],W={key:1,class:"text-sm text-slate-500"},ae=k({__name:"AgentPageShell",props:{title:{},hideActions:{type:Boolean}},setup(f){const i=$(!1),y=V(),l=T(),{agent:d,isLoading:h,isSaving:c}=C(l),{isAuthenticated:g}=j(),{canEditAgents:v}=E(),x=n=>Array.isArray(n)?n[0]:n;S(()=>y.params.id,n=>{const e=x(n);e&&l.ensureAgentLoaded(e)},{immediate:!0});const b=async()=>{await l.saveAgent()},_=()=>{L("/agents")},w=()=>{i.value=!1,window.location.reload()};return(n,e)=>(o(),a("div",null,[s(g)?r("",!0):(o(),a("div",I,[t("div",K,[t("div",q,[m(s(P),{class:"h-5 w-5 text-yellow-400 mr-3"}),e[2]||(e[2]=t("div",null,[t("h3",{class:"text-sm font-medium text-yellow-800"}," Требуется аутентификация "),t("p",{class:"text-sm text-yellow-700 mt-1"}," Войдите в систему для редактирования агента ")],-1))]),t("button",{onClick:e[0]||(e[0]=A=>i.value=!0),class:"px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 transition-colors"}," Войти ")])])),s(h)?(o(),a("div",z,[...e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):s(d)?(o(),a("div",F,[t("div",G,[t("div",null,[t("h1",H,u(f.title),1),t("p",J,u(s(d).name),1)]),n.$props.hideActions?r("",!0):(o(),a("div",O,[s(v)?(o(),a("div",Q,[t("button",{onClick:_,class:"px-6 py-2.5 text-slate-600 font-medium hover:text-slate-900 transition-colors"}," Отменить "),t("button",{onClick:b,disabled:s(c),class:"px-8 py-2.5 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"},[s(c)?(o(),p(s(R),{key:0,class:"h-4 w-4 animate-spin"})):(o(),p(s(D),{key:1,class:"h-4 w-4"})),e[4]||(e[4]=B(" Сохранить ",-1))],8,U)])):(o(),a("div",W," Режим просмотра "))]))]),N(n.$slots,"default")])):r("",!0),m(M,{"is-open":i.value,onClose:e[1]||(e[1]=A=>i.value=!1),onAuthenticated:w},null,8,["is-open"])]))}});export{ae as _};
