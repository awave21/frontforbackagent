import{m as A,y as C,f as S,c as l,a as t,u as s,b as m,p as r,t as u,n as f,d as B,K as $,k as L,Q as N,P as V,o}from"./entry.Dw2909n2.js";import{u as j}from"./useAuth.jgUYoTAC.js";import{u as E}from"./usePermissions.B76kzDEP.js";import{u as P}from"./useAgentEditorStore.C_-cPj_T.js";import{_ as T}from"./AuthModal.vue.BSzxuO2s.js";import{A as R}from"./alert-circle.CFB8cae4.js";import{L as D}from"./loader-2.D-f1OOw-.js";import{C as I}from"./check.CexbSXYH.js";const K={class:"h-full p-6 max-w-7xl mx-auto"},M={class:"h-full flex flex-col"},Q={key:0,class:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4"},q={class:"flex items-center justify-between"},z={class:"flex items-center"},F={key:1,class:"flex justify-center py-12"},G={key:2,class:"flex flex-col flex-1 min-h-0 gap-4"},H={class:"flex items-center justify-between shrink-0"},J={class:"flex items-center gap-3"},O={class:"text-sm text-slate-400 font-normal"},U={class:"text-sm text-slate-500 font-normal"},W={key:0},X={key:0,class:"flex items-center gap-3"},Y=["disabled"],Z={key:1,class:"text-sm text-slate-500"},re=A({__name:"AgentPageShell",props:{title:{},hideActions:{type:Boolean}},setup(p){const a=L(!1),x=V(),i=P(),{agent:d,isLoading:h,isSaving:c}=C(i),{isAuthenticated:y}=j(),{canEditAgents:g}=E(),v=n=>Array.isArray(n)?n[0]:n;S(()=>x.params.id,n=>{const e=v(n);e&&i.ensureAgentLoaded(e)},{immediate:!0});const _=async()=>{await i.saveAgent()},w=()=>{N("/agents")},b=()=>{a.value=!1,window.location.reload()};return(n,e)=>(o(),l("div",K,[t("div",M,[s(y)?r("",!0):(o(),l("div",Q,[t("div",q,[t("div",z,[m(s(R),{class:"h-5 w-5 text-yellow-400 mr-3"}),e[2]||(e[2]=t("div",null,[t("h3",{class:"text-sm font-medium text-yellow-800"}," Требуется аутентификация "),t("p",{class:"text-sm text-yellow-700 mt-1"}," Войдите в систему для редактирования агента ")],-1))]),t("button",{onClick:e[0]||(e[0]=k=>a.value=!0),class:"px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 transition-colors"}," Войти ")])])),s(h)?(o(),l("div",F,[...e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):s(d)?(o(),l("div",G,[t("div",H,[t("div",J,[t("h1",O,u(p.title),1),e[4]||(e[4]=t("span",{class:"text-slate-300"},"/",-1)),t("span",U,u(s(d).name),1)]),n.$props.hideActions?r("",!0):(o(),l("div",W,[s(g)?(o(),l("div",X,[t("button",{onClick:w,class:"px-6 py-2.5 text-slate-600 font-medium hover:text-slate-900 transition-colors"}," Отменить "),t("button",{onClick:_,disabled:s(c),class:"px-8 py-2.5 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2"},[s(c)?(o(),f(s(D),{key:0,class:"h-4 w-4 animate-spin"})):(o(),f(s(I),{key:1,class:"h-4 w-4"})),e[5]||(e[5]=B(" Сохранить ",-1))],8,Y)])):(o(),l("div",Z," Режим просмотра "))]))]),$(n.$slots,"default")])):r("",!0),m(T,{"is-open":a.value,onClose:e[1]||(e[1]=k=>a.value=!1),onAuthenticated:b},null,8,["is-open"])])]))}});export{re as _};
