import{u as P,a as N}from"./useAuth.Dtl-sXO9.js";import{P as o,r as u}from"./entry.d9x2jNom.js";const R=()=>{P();const n=N(),a=u(!1),r=u(null),c=u([]),v=u(null),y=u([]),h=u([]),g=u([]),i=u(!1),l=u(null),S=async s=>{try{a.value=!0,r.value=null;const e=new URLSearchParams;s!=null&&s.limit&&e.append("limit",s.limit.toString()),s!=null&&s.offset&&e.append("offset",s.offset.toString());const t=await n("/agents",{query:Object.fromEntries(e)});return c.value=t,t}catch(e){throw r.value=e.message||"Ошибка загрузки агентов",e}finally{a.value=!1}},d=async s=>{try{a.value=!0,r.value=null;const e=await n("/agents",{method:"POST",headers:{"Content-Type":"application/json"},body:s});return c.value.unshift(e),e}catch(e){throw r.value=e.message||"Ошибка создания агента",e}finally{a.value=!1}},q=async s=>{try{return a.value=!0,r.value=null,await n(`/agents/${s}`)}catch(e){throw r.value=e.message||"Ошибка загрузки агента",e}finally{a.value=!1}},w=async(s,e)=>{try{a.value=!0,r.value=null;const t=await n(`/agents/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:e}),f=c.value.findIndex(T=>T.id===s);return f!==-1&&(c.value[f]=t),t}catch(t){throw r.value=t.message||"Ошибка обновления агента",t}finally{a.value=!1}},p=async s=>{try{a.value=!0,r.value=null,await n(`/agents/${s}`,{method:"DELETE"}),c.value=c.value.filter(e=>e.id!==s)}catch(e){throw r.value=e.message||"Ошибка удаления агента",e}finally{a.value=!1}},m=async s=>{try{i.value=!0,l.value=null;const e=await n(`/agents/${s}/sqns`);return v.value=e,e}catch(e){throw l.value=e.message||"Ошибка загрузки SQNS-статуса",e}finally{i.value=!1}},E=async(s,e)=>{try{i.value=!0,l.value=null;const t=await n(`/agents/${s}/sqns/enable-by-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:e});return v.value=t,t}catch(t){throw l.value=t.message||"Ошибка включения SQNS",t}finally{i.value=!1}},b=async s=>{try{i.value=!0,l.value=null,await n(`/agents/${s}/sqns`,{method:"DELETE"}),v.value={sqnsEnabled:!1}}catch(e){throw l.value=e.message||"Ошибка отключения SQNS",e}finally{i.value=!1}},$=async s=>{try{const e=await n(`/agents/${s}/sqns/resources`);return y.value=e.resources??[],y.value}catch(e){throw l.value=e.message||"Ошибка загрузки ресурсов SQNS",e}},A=async s=>{try{const e=await n(`/agents/${s}/sqns/services`);return h.value=e.services??[],h.value}catch(e){throw l.value=e.message||"Ошибка загрузки услуг SQNS",e}},L=async(s,e)=>{try{const t=new URLSearchParams;e.resourceId&&t.append("resourceId",e.resourceId.toString()),e.date&&t.append("date",e.date);const f=await n(`/agents/${s}/sqns/slots`,{query:Object.fromEntries(t)});return g.value=f.slots??[],g.value}catch(t){throw l.value=t.message||"Ошибка загрузки слотов SQNS",t}};return{agents:o(c),isLoading:o(a),error:o(r),fetchAgents:S,createAgent:d,getAgent:q,updateAgent:w,deleteAgent:p,sqnsStatus:o(v),sqnsResources:o(y),sqnsServices:o(h),sqnsSlots:o(g),isSqnsLoading:o(i),sqnsError:o(l),fetchSqnsStatus:m,enableSqns:E,disableSqns:b,fetchSqnsResources:$,fetchSqnsServices:A,fetchSqnsSlots:L}};export{R as u};
